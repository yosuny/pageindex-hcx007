# PageIndex with HyperCLOVA X Reasoning Model

**NCloud HCX-007 (HyperCLOVA X Reasoning Model)ì„ í™œìš©í•œ PageIndex RAG ì‹œìŠ¤í…œ ë¹„êµ ì‹¤í—˜**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

---

## ğŸ“Œ í”„ë¡œì íŠ¸ ê°œìš”

ì´ í”„ë¡œì íŠ¸ëŠ” [PageIndex](https://github.com/ofirpress/pageindex) ë…¼ë¬¸ì˜ êµ¬ì¡° ê¸°ë°˜ ë¬¸ì„œ ê²€ìƒ‰ ë°©ì‹ì„ **NCloud HyperCLOVA X (HCX-007)** ë¦¬ì¦ˆë‹ ëª¨ë¸ì— ì ìš©í•˜ì—¬, ê¸°ì¡´ Vector RAG ë°©ì‹ê³¼ ì„±ëŠ¥ì„ ë¹„êµ ë¶„ì„í•œ ì‹¤í—˜ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

### ğŸ¯ ëª©ì 

1. **PageIndex ë°©ì‹ì˜ í•œêµ­ì–´ ë²•ë¥  ë¬¸ì„œ ì ìš© ê°€ëŠ¥ì„± ê²€ì¦**
2. **HCX-007 ë¦¬ì¦ˆë‹ ëª¨ë¸ì˜ OpenAI ëŒ€ì²´ ê°€ëŠ¥ì„± í‰ê°€**
3. **Vector RAG vs Tree-based RAG ì •ëŸ‰ì  ë¹„êµ**

---

## ğŸ§ª ì‹¤í—˜ ê²°ê³¼ ìš”ì•½

### í‰ê°€ ë°ì´í„°ì…‹
- **Golden Set**: 20ê°œ QA ë¬¸í•­
  - AI ê¸°ë³¸ë²• ë° 5ëŒ€ ê°€ì´ë“œë¼ì¸: 15ë¬¸í•­
  - êµ­ê°€í•µì‹¬ê¸°ìˆ  í´ë¼ìš°ë“œ ë³´ì•ˆ ê°€ì´ë“œë¼ì¸: 5ë¬¸í•­

### í…ŒìŠ¤íŠ¸ ë¬¸ì„œ ëª©ë¡

> PDF ì›ë³¸ì€ ìš©ëŸ‰ ë¬¸ì œë¡œ Gitì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì•„ë˜ ë¬¸ì„œë¥¼ `comparison/data/documents/`ì— ë°°ì¹˜í•˜ì„¸ìš”.

| # | ë¬¸ì„œëª… | ì¶œì²˜ |
|---|---|---|
| 1 | ì¸ê³µì§€ëŠ¥ ê¸°ë³¸ë²• (ë²•ë¥  ì œ21311í˜¸) | êµ­ê°€ë²•ë ¹ì •ë³´ì„¼í„° |
| 2 | ì¸ê³µì§€ëŠ¥ íˆ¬ëª…ì„± í™•ë³´ ê°€ì´ë“œë¼ì¸ | ê³¼ê¸°ì •í†µë¶€ |
| 3 | ì¸ê³µì§€ëŠ¥ ì•ˆì „ì„± í™•ë³´ ê°€ì´ë“œë¼ì¸ | ê³¼ê¸°ì •í†µë¶€ |
| 4 | ê³ ì˜í–¥ ì¸ê³µì§€ëŠ¥ íŒë‹¨ ê°€ì´ë“œë¼ì¸ | ê³¼ê¸°ì •í†µë¶€ |
| 5 | ê³ ì˜í–¥ ì¸ê³µì§€ëŠ¥ ì‚¬ì—…ì ì±…ë¬´ ê°€ì´ë“œë¼ì¸ | ê³¼ê¸°ì •í†µë¶€ |
| 6 | ì¸ê³µì§€ëŠ¥ ì˜í–¥í‰ê°€ ê°€ì´ë“œë¼ì¸ | ê³¼ê¸°ì •í†µë¶€ |
| 7 | êµ­ê°€í•µì‹¬ê¸°ìˆ  í´ë¼ìš°ë“œ ë³´ì•ˆê´€ë¦¬ ì•ˆë‚´ì„œ | ì‚°ì—…í†µìƒìì›ë¶€ |

### ì„±ëŠ¥ ë¹„êµ (N=20)

| ì§€í‘œ | Vector RAG | PageIndex RAG |
|---|:---:|:---:|
| **í‰ê·  ì ìˆ˜ (1-5)** | **3.15** | 2.85 |
| **í‰ê·  ì‘ë‹µ ì‹œê°„** | **17.5ì´ˆ** | 107.3ì´ˆ |
| **ë¬¸ì„œ ê²€ìƒ‰ ì ì¤‘ë¥ ** | 15% | **25%** |

> *0ì  ì˜¤ë¥˜ ì¼€ì´ìŠ¤ ì œì™¸ ì‹œ: Vector RAG 3.47 vs PageIndex RAG 3.0*

### ì£¼ìš” ë°œê²¬

| í•­ëª© | ë‚´ìš© |
|---|---|
| âœ… **Vector RAG ê°•ì ** | ë¹ ë¥¸ ì‘ë‹µ ì†ë„, ë†’ì€ ë‹µë³€ í’ˆì§ˆ |
| âœ… **PageIndex ê°•ì ** | ì •í™•í•œ ë¬¸ì„œ ì„ ë³„ (Global Routing) |
| âš ï¸ **HCX-007 í•œê³„** | JSON ì¶œë ¥ ì¼ê´€ì„± ë¶€ì¡±, ì‘ë‹µ ì‹œê°„ ì§€ì—° |

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Comparison UI (Gradio)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     Vector RAG      â”‚     â”‚     PageIndex RAG       â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ Semantic Chunking â”‚     â”‚ â€¢ Tree Structure        â”‚   â”‚
â”‚  â”‚ â€¢ Qdrant Vector DB  â”‚     â”‚ â€¢ Global Router         â”‚   â”‚
â”‚  â”‚ â€¢ Top-K Retrieval   â”‚     â”‚ â€¢ LLM-based Navigation  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  NCloud HCX-007 (LLM Backend)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‚ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
PageIndex/
â”œâ”€â”€ comparison/                 # ë¹„êµ ì‹¤í—˜ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ modules/               # RAG êµ¬í˜„ì²´
â”‚   â”‚   â”œâ”€â”€ vector_rag.py      # Vector RAG
â”‚   â”‚   â”œâ”€â”€ pageindex_rag.py   # PageIndex RAG
â”‚   â”‚   â”œâ”€â”€ pageindex_router.py # Global Routing
â”‚   â”‚   â””â”€â”€ ncloud_llm.py      # HCX-007 Wrapper
â”‚   â”œâ”€â”€ data/
â”‚   â”‚   â”œâ”€â”€ documents/         # í…ŒìŠ¤íŠ¸ PDF ë¬¸ì„œ
â”‚   â”‚   â”œâ”€â”€ cache/             # íŠ¸ë¦¬ ìºì‹œ
â”‚   â”‚   â””â”€â”€ results/           # í‰ê°€ ê²°ê³¼
â”‚   â””â”€â”€ evaluator.py           # ìë™ í‰ê°€ ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ comparison_ui.py           # Gradio UI
â”œâ”€â”€ pageindex/                 # ì›ë³¸ PageIndex ë¼ì´ë¸ŒëŸ¬ë¦¬
â””â”€â”€ requirements.txt
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •

```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
pip install -r requirements.txt
```

### 2. API í‚¤ ì„¤ì •

`.env` íŒŒì¼ ìƒì„±:
```env
NCLOUD_API_KEY=your_api_key
NCLOUD_API_URL=https://clovastudio.stream.ntruss.com/v3/chat-completions/HCX-007
```

### 3. UI ì‹¤í–‰

```bash
python comparison_ui.py
# ë¸Œë¼ìš°ì €ì—ì„œ http://127.0.0.1:7860 ì ‘ì†
```

### 4. í‰ê°€ ì‹¤í–‰

```bash
python comparison/evaluator.py
# ê²°ê³¼: comparison/data/results/
```

---

## ğŸ“š Lessons Learned

### 1. HCX-007ì˜ OpenAI ëŒ€ì²´ í•œê³„

| ë¬¸ì œ | ì›ì¸ | í•´ê²°ì±… |
|---|---|---|
| **JSON íŒŒì‹± ì˜¤ë¥˜ ë¹ˆë°œ** | ë¦¬ì¦ˆë‹ ê³¼ì •ì´ ì‘ë‹µì— í¬í•¨ë¨ | Regex fallback ì¶”ê°€ |
| **ì‘ë‹µ ì‹œê°„ 6ë°° ëŠë¦¼** | `thinking_effort` íŒŒë¼ë¯¸í„° ì˜í–¥ | Low/Medium ì¡°ì • |
| **êµ¬ì¡°í™” ì¶œë ¥ ë¶ˆì•ˆì •** | í”„ë¡¬í”„íŠ¸ ë¬´ì‹œ ê²½í–¥ | í›„ì²˜ë¦¬ ë¡œì§ ê°•í™” í•„ìš” |

### 2. PageIndex ë°©ì‹ì˜ íŠ¹ì„±

- **ì¥ì **: ëª…í™•í•œ ë¬¸ì„œ êµ¬ì¡°ê°€ ìˆëŠ” ë²•ë¥ /ê¸°ìˆ  ë¬¸ì„œì— íš¨ê³¼ì 
- **ë‹¨ì **: íŠ¸ë¦¬ ìƒì„±ì— LLM í˜¸ì¶œ ë‹¤ìˆ˜ í•„ìš” â†’ ë¹„ìš©/ì‹œê°„ ì¦ê°€
- **ê°œì„ ì **: ìºì‹± ì „ëµìœ¼ë¡œ ì´ˆê¸° ë¹„ìš© ìƒì‡„ ê°€ëŠ¥

### 3. í‰ê°€ ë°©ë²•ë¡ 

- **LLM-as-a-Judge** ë°©ì‹ì€ JSON ì¶œë ¥ ì¼ê´€ì„±ì— í¬ê²Œ ì˜ì¡´
- ê°•ê±´í•œ íŒŒì‹± ë¡œì§(Regex, ë²”ìœ„ ì¶”ì¶œ) í•„ìˆ˜

---

## ğŸ”® í–¥í›„ ê°œì„  ê³¼ì œ

1. **HCX-007 JSON ëª¨ë“œ í™œìš©**: êµ¬ì¡°í™” ì¶œë ¥ API ì˜µì…˜ íƒìƒ‰
2. **Global Routing ì •í™•ë„ í–¥ìƒ**: í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ê°•í™”
3. **í•˜ì´ë¸Œë¦¬ë“œ ì ‘ê·¼**: Vector + PageIndex ê²°í•© ì „ëµ ì‹¤í—˜
4. **ëŒ€ê·œëª¨ í‰ê°€**: 100+ ë¬¸í•­ìœ¼ë¡œ í†µê³„ì  ìœ ì˜ì„± í™•ë³´

---

## ğŸ“„ ì°¸ê³  ìë£Œ

- [PageIndex ë…¼ë¬¸](https://arxiv.org/abs/2501.xyz) - ì›ë³¸ ì—°êµ¬
- [NCloud HyperCLOVA X](https://www.ncloud.com/product/aiService/clovaStudio) - LLM API
- [Qdrant](https://qdrant.tech/) - Vector Database

---

## ğŸ“ ë¼ì´ì„ ìŠ¤

MIT License - ìì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ ì°¸ì¡°

---

*Last Updated: 2026-01-28*
